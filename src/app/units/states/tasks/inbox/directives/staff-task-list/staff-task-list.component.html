<div class="panel panel-primary">
  <div class="panel-heading">
    <div class="input-group">
      <input
        type="text"
        class="form-control"
        [(ngModel)]="filters.studentName"
        (change)="studentNameChanged()"
        placeholder="Search students..."
      />
      <span class="input-group-btn">
        <button
          class="btn btn-default btn-search-opts-toggle"
          type="button"
          [(ngModel)]="showSearchOptions"
          btn-checkbox
        >
          <i class="fa fa-chevron-{{ showSearchOptions ? 'up' : 'down' }}"></i>
        </button>
        <button class="btn btn-default" type="button" (click)="refreshTasks()">
          <i class="fa fa-refresh"></i>
        </button>
      </span>
      <!--/search-options-toggle-->
    </div>
    <!--/search-->
  </div>
  <form class="panel-body search-options" [hidden]="!showSearchOptions">
    <div class="task-definition">
      <div class="dropdown" dropdown>
        <label>Task Definition</label>
        <i
          *ngIf="isTaskDefMode"
          class="fa fa-download pull-right dropdown-toggle"
          style="cursor: pointer; padding-top: 8px; padding-right: 8px;"
          dropdown-toggle
        ></i>
        <ul class="dropdown-menu pull-right">
          <li>
            <a [href]="submissionsPdfsUrl">Bulk Export Submission PDFs</a>
          </li>
          <li>
            <a [href]="submissionsUrl">Bulk Export Submission Files</a>
          </li>
        </ul>
      </div>
      <mat-form-field>
        <mat-select
          [(ngModel)]="filters.taskDefinitionIdSelected"
          name="taskDefID"
          (change)="taskDefinitionIdChanged()"
        >
          <mat-option
            *ngFor="let td of unit.task_definitions"
            [value]="td.value"
          >
            {{ td.abbreviation + " - " + td.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <p class="help-block">
        You can choose to display submissions of a specific task definition
        here.
      </p>
    </div>
    <!--/task-definition-->
    <div class="form-group tutorial">
      <label>Tutorials</label>
      <div class="input-group col-sm-12">
        <select
          [(ngModel)]="filters.tutorialIdSelected"
          ng-options="t.id as t.inbox_description for t in tutorials | orderBy:'abbreviation'"
          (change)="tutorialIdChanged()"
          class="form-control input-md"
        >
        </select>
      </div>
      <p class="help-block">
        You can choose to display submissions from all tutorials or just your
        tutorials.
      </p>
    </div>
    <!--/tutorial-->
  </form>
  <!--/search-options-->
  <ul class="list-group">
    <li
      class="list-group-item list-group-item-task clearfix {{
        task.statusClass()
      }}"
      id="{{ task.taskKeyToIdString() }}"
      (click)="setSelectedTask(task)"
      [ngClass]="{ selected: isSelectedTask(task) }"
      *ngFor="let task of filteredTasks"
    >
      <user-icon
        [user]="task.project()"
        [email]="task.project().student_email"
        [size]="50"
      >
      </user-icon>
      <div class="task-data">
        <h4 class="list-group-item-heading">
          {{ task.project().name }}
        </h4>
        <p class="list-group-item-text">
          {{ task.definition.abbreviation }} - {{ task.definition.name }}
        </p>
        <div
          class="list-group-item-text-extended"
          [hidden]="!isSelectedTask(task)"
        >
          <p>
            {{ task.project().shortTutorialDescription() }}
          </p>
          <p>Submitted {{ task.submission_date }}</p>
          <p [hidden]="!(task.times_assessed > 0)">
            Assessed {{ task.times_assessed }} time{{
              task.times_assessed == 1 ? "" : "s"
            }}
          </p>
        </div>
      </div>
      <!--/task-data-->
      <div class="task-badges">
        <!-- <status-icon status="task.status"></status-icon> -->
        <div class="task-superscript-badges">
          <span
            class="task-superscript-badge new-comments-badge"
            *ngIf="task.num_new_comments > 0"
          >
            {{ task.num_new_comments }}
          </span>
          <span
            class="task-superscript-badge plagiarism-detected-badge"
            *ngIf="task.plagiarismDetected()"
          >
            <i class="fa fa-eye"></i>
          </span>
        </div>
        <div class="task-subscript-badges">
          <span
            class="task-subscript-badge grade-badge"
            *ngIf="task.hasGrade()"
          >
            {{ task.gradeDesc() }}
          </span>
          <span
            class="task-subscript-badge quality-badge"
            *ngIf="task.hasQualityPoints()"
          >
            <sup>{{ task.quality_pts }}</sup
            >&frasl;<sub>{{ task.definition.max_quality_pts }}</sub>
          </span>
        </div>
      </div>
      <!--/badges-->
    </li>
    <!--/task-->
    <li
      [hidden]="filteredTasks.length != 0"
      class="list-group-item text-center text-muted"
    >
      <div id="empty-task-inbox">
        <img src="/assets/images/empty_task_inbox.svg" alt="Empty task inbox" />
        No tasks to display!
      </div>
    </li>
  </ul>
</div>
